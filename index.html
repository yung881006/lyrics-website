<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ê≠åË©ûÁ∂≤Á´ô</title>
  <style>
    :root {
      --lyrics-font-size: 16px;
      --bg-light: #fff;
      --text-light: #000;
      --bg-dark: #222;
      --text-dark: #ddd;
    }
    [data-theme="light"] {
      background-color: var(--bg-light);
      color: var(--text-light);
    }
    [data-theme="dark"] {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    body {
      font-family: "Microsoft JhengHei", sans-serif;
      margin: 0;
      font-size: var(--lyrics-font-size);
      transition: background-color 0.3s, color 0.3s;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    #mainLayout {
      display: flex;
      flex-direction: row;
      width: 100%;
      height: 100%;
    }

    #leftPanel {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1rem;
      width: 200px;
      min-width: 180px;
    }

    .controls button {
      display: block;
      margin: 0.25rem 0;
    }

    #rightPanel {
      flex-grow: 1;
      padding: 1rem;
    }

    #pageHeader {
      margin-bottom: 1rem;
    }

    input[type="text"] {
      padding: 0.5rem;
      font-size: 1rem;
      width: 60%;
      max-width: 400px;
    }

    button {
      padding: 0.5rem 1rem;
      margin-left: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
    }

    ul#lyricsList {
      list-style: none;
      padding: 0;
    }

    ul#lyricsList li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #ccc;
      cursor: pointer;
    }

    ul#lyricsList li:hover {
      background-color: #eee;
    }

    #lyricsDetails {
      white-space: pre-wrap;
      line-height: 1.5;
    }

    .languageButtons {
      display: none;
    }
  </style>
</head>
<body>
  <div id="mainLayout">
    <!-- Â∑¶ÂÅ¥ÊéßÂà∂ÂçÄ -->
    <div id="leftPanel">
      <button id="themeToggle" aria-label="ÂàáÊèõÊ∑±Ëâ≤Ê®°Âºè">üåô</button>
      <div class="controls" aria-label="Â≠óÈ´îÂ§ßÂ∞èÊéßÂà∂">
        <label>Â≠óÈ´îÂ§ßÂ∞èÔºö</label>
        <button onclick="setFontSize('small')">Â∞è</button>
        <button onclick="setFontSize('medium')">‰∏≠</button>
        <button onclick="setFontSize('large')">Â§ß</button>
        <button onclick="setFontSize('xlarge')">ÁâπÂ§ß</button>
      </div>
    </div>

    <!-- Âè≥ÂÅ¥‰∏ªÂÖßÂÆπÂçÄ -->
    <div id="rightPanel">
      <div id="pageHeader">
        <h1>Ê≠åË©ûÁ∂≤Á´ô</h1>
        <input type="text" id="search" placeholder="ÊêúÁ¥¢Ê≠åË©û„ÄÅÊ≠åÊâãÊàñÊ®ôÈ°å" oninput="debounceSearch()" aria-label="ÊêúÁ¥¢Ê≠åË©û„ÄÅÊ≠åÊâãÊàñÊ®ôÈ°å" />
        <button onclick="searchLyrics()">Êü•Ë©¢</button>
      </div>

      <ul id="lyricsList"></ul>

      <div id="lyricsDetails" style="display:none;">
        <h2 id="songTitle"></h2>
        <pre id="fullLyrics"></pre>
        <button onclick="goBack()">ËøîÂõû</button>
      </div>
    </div>
  </div>

  <script>
    const lyricsData = [
      {
        "title": "„ÇÇ„Åó„ÇÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÊÅã„Çí„Åô„Çã„ÅÆ„Å™„Çâ",
        "artist": "Ai Higuchi",
        "lyrics_ja": [
          "„Å©„Å£„Å°„Åß„ÇÇ„ÅÑ„ÅÑ„Å™„Çì„Å¶",
          "Âº∑„Åå„Çä„Å†„Çà",
          "„Åª„Çì„Å®„ÅÆÊ∞óÊåÅ„Å°",
          "„Çè„Åã„Çã„Åß„Åó„Çá",
          "ÊõñÊòß„Å´„Åó„Å¶„Åç„Åü„ÅÆ„ÅØ",
          "‰∏°ÊàêÊïó„Å†„Çà",
          "Ë¨ù„Çâ„Å™„ÅÑ„Åó",
          "Ë¨ù„Çâ„Å™„ÅÑ„Åß",
          "Èï∑„ÅèÈï∑„ÅèÂêå„Åò„ÇÇ„ÅÆ„Çí",
          "Âê∏„Å£„Å¶Âêê„ÅÑ„Å¶",
          "„Åù„Çä„ÇÉ‰ºº„Å¶„Åç„Å°„ÇÉ„ÅÜ„Å≠",
          "ÊúÄÂæå„ÅÆÊÅã„Å´„Åï„Åõ„Å¶",
          "„ÅÑ„Å§„ÇÇ„Åù„Å∞„Å´„ÅÑ„Å¶",
          "„Å§„Åæ„Çâ„Å™„ÅÑ„Åè„Å†„Çâ„Å™„ÅÑ",
          "Êó•„ÄÖ„ÇíÊÑõ„Åó„Å¶",
          "„ÇÇ„Åó„ÇÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶",
          "ÊÅã„Çí„Åô„Çã„ÅÆ„Å™„Çâ",
          "„ÅÇ„Å™„Åü„Å®Âá∫‰ºö„Å£„Å¶",
          "Âêå„ÅòÈÅì„ÇíÊ≠©„Åç„Åü„ÅÑ",
          "„Éè„ÉÉ„Éî„Éº„Ç®„É≥„Éâ„ÅÆÂêë„Åì„ÅÜÂÅ¥„Å∏"
        ],
        "lyrics_romaji": [
          "Docchi demo ii nante",
          "Tsuyogari da yo",
          "Honto no kimochi",
          "Wakaru desho",
          "Aimai ni shite kita no wa",
          "Ryouseibai da yo",
          "Ayamaranai shi",
          "Ayamaranai de",
          "Nagaku nagaku onaji mono wo",
          "Sutte haite",
          "Sorya nite kichau ne",
          "Saigo no koi ni sasete",
          "Itsumo soba ni ite",
          "Tsumaranai kudaranai",
          "Hibi wo aishite",
          "Moshimo mou ichido",
          "Koi wo suru no nara",
          "Anata to deatte",
          "Onaji michi wo arukitai",
          "Happii endo no mukougawa e"
        ],
        "lyrics_zh": [
          "ÈÄôÊ®£‰πüÊ≤íÈóú‰øÇÂï¶",
          "ÈÄûÂº∑ËÄåÂ∑≤",
          "ÁúüÊ≠£ÁöÑÂøÉÊÉÖ",
          "‰Ω†Áü•ÈÅìÁöÑÂêß",
          "‰∏ÄÁõ¥Âê´Á≥äÂÖ∂Ëæ≠",
          "ÈõôÊñπÈÉΩÊúâÈåØ",
          "‰∏çÈÅìÊ≠â",
          "Ë´ã‰∏çË¶ÅÈÅìÊ≠â",
          "Èï∑‰πÖÂú∞ÂëºÂê∏ËëóÁõ∏ÂêåÁöÑÊù±Ë•ø",
          "Âê∏Ê∞£ÂêêÊ∞£",
          "Áï∂ÁÑ∂ÊúÉËÆäÂæóÁõ∏‰ºº",
          "ËÆìÈÄôÊàêÁÇ∫ÊúÄÂæåÁöÑÊàÄÊÑõ",
          "Á∏ΩÊòØÂæÖÂú®Ë∫´ÊóÅ",
          "ÁÑ°ËÅäÂèàÁÑ°ÊÑèÁæ©",
          "ÁèçÊÉúÊØè‰∏ÄÂ§©",
          "Â¶ÇÊûúËÉΩÂÜç‰∏ÄÊ¨°",
          "ÊàÄÊÑõÁöÑË©±",
          "ÊÉ≥Ë¶ÅÈÅáË¶ã‰Ω†",
          "ÊÉ≥Ëµ∞Âêå‰∏ÄÊ¢ùË∑Ø",
          "ÂæÄÂπ∏Á¶èÁµêÂ±ÄÁöÑÂè¶‰∏ÄÈÇä"
        ]
      },
      {
        "title": "„Éö„Ç¢„É™„É≥„Ç∞",
        "artist": "Èü≥Áî∞ÈõÖÂâá",
        "lyrics_ja": [
          "‰ªäÊó•„ÅØÂêõ„Å®Âá∫‰ºö„Å£„Å¶„Åã„Çâ",
          "3„Å®4„É∂Êúà„ÅåÁµå„Å£„Å¶",
          "Â§â„Çè„Çâ„ÅöÊâãÁ¥ô„ÅåÂ±ä„Åè„ÅÆ„ÅØ",
          "Ê∞∏ÈÅ†Ôºà„Å®„ÇèÔºâ„Å´Á∂öÔºà„Å§„Å•Ôºâ„ÅÑ„Å¶„Åè„Å†„Çç„ÅÜ„Å≠",
          "„Éö„Ç¢„É™„É≥„Ç∞ÁâáÊâãÂêåÂ£´„Å§„Åë„Å¶",
          "ÊâãÁπã„ÅÑ„ÅßÂùÇÈÅìÁôª„Å£„Å¶",
          "‰ºëÊó•„Åî„Çç„Åî„Çç„Åó„Å™„Åå„Çâ„ÇÇ",
          "‰ΩïÊ∞ó„Å™„ÅÑÊó•„ÄÖ„ÇíÈÅé„Åî„Åó„Å¶Ë°å„Åè„Çì„Å†",
          "Â•Ω„Åç„Åï",
          "Áîü„Åæ„ÇåÂ§â„Çè„Å£„Å¶„ÇÇ",
          "„Åç„Å£„Å®Âêõ„ÅÆÂÖÉ„Å∏„Å®",
          "Ëøé„Åà„Å´Ë°å„Åè„Å†„Çç„ÅÜ",
          "‰∏ñÁïå‰∏≠„Å´„Åì„Çì„Å™Á¥†Êïµ„Å™‰∫∫„ÅØË¶ãÂΩì„Åü„Çâ„Å™„ÅÑ„Å™„ÅÅ",
          "„Ç´„É°„É©„Åß„ÉØ„É≥„Ç∑„Éß„ÉÉ„Éà„ÉÑ„Éº„Ç∑„Éß„ÉÉ„Éà„Å™„Çì„Å¶",
          "ÊÑõ„Åó„Åè„Å¶„Éã„É§„Åë„Å¶Âõ∞„Å£„Å°„ÇÉ„ÅÜ„Å™",
          "Âêõ„ÅÆÁ¨ëÈ°î„Çí„Åö„Å£„Å®Áú∫„ÇÅ„Å¶„Åü„Çâ",
          "ÊÅ•„Åö„Åã„Åó„ÅÑ„Å™",
          "ÁõÆ„Å®ÁõÆÂêà„Çè„Åõ„Å¶„Åª„Çâ„Åæ„Åü",
          "Âêõ„Å´ÊÅã„Åó„Å¶„Çã",
          "„Éê„Ç§„Éê„Ç§„Åô„ÇãÊôÇ„ÅØÂøÖ„Åö",
          "Â§ß„Åç„ÅèÊâã„ÇíÊåØ„ÇäÂêà„ÅÜÂÉï„Çâ",
          "‰∏çÊÑè„Å´Êä±„Åç„Å§„ÅÑ„Å¶„Åè„ÇãÂêõ",
          "Ê∫¢„Çå„ÇãÂπ∏„Åõ„ÅÆÊØéÊó•",
          "„Åç„Å£„Å®„Åì„ÅÆÂÖà‰ΩïÂπ¥„ÇÇ",
          "ÂÖ±„Å´Ê≠©„Çì„Åß„Åè„Å†„Çç„ÅÜ„Å≠",
          "„Å†„Åã„Çâ„Åì„Åù„ÅÆ‰∏ÄÊ≠©„Åö„Å§„Çí",
          "Â§ßÂàá„Å´„Åó„Å¶„ÅÑ„Åì„ÅÜ„Å≠",
          "Â§ßÂ•Ω„Åç„Åï",
          "„Åì„Çå‰ª•‰∏ä„ÅÆÂπ∏„Åõ„Çí",
          "Ë®ÄËëâ„Å´‰πó„Åõ„Å¶",
          "‰ºù„Åà„Å¶Ë°å„Åè„Åã„Çâ",
          "Only girl",
          "Âêõ‰ª•‰∏ä„ÅÆ‰∫∫„Å™„Çì„Å¶„Å©„Åì„Å´„ÇÇ„ÅÑ„Å™„ÅÑ„Çà",
          "‰æã„ÅàÂñßÂò©„Åó„Åü„Å£„Å¶",
          "Èõ¢„Çå„Åã„Åë„Åü„Å£„Å¶",
          "ÈÅãÂëΩ„ÅÆ‰∫∫„Å´Â§â„Çè„Çä„ÅØ„Å™„ÅÑ„Åã„Çâ",
          "„Äå„Åì„ÅÆÁ¥†Êïµ„Å™‰∫∫„ÅåÂÉï„ÅÆÂ§ßÂàá„Å™ÊÅã‰∫∫„Å†„Äç„Å®",
          "‰∏ñÁïå‰∏≠„Å´Ëá™ÊÖ¢„Åó„Å¶",
          "Êó•„ÄÖ„Å´Ëä±„ÇíÂí≤„Åã„Åô",
          "100Âπ¥Âæå„ÇÇ",
          "Âêõ„ÇíÊÑõ„Åó„Å¶„ÅÑ„ÇãËá™‰ø°„Åó„Åã„Å™„ÅÑ„Å™",
          "„Å≠„Åá",
          "„ÅÑ„Å§„ÇÇÈÄö„Çä",
          "‰ΩïÊ∞ó„Å™„ÅÑ‰ºöË©±„Å†„Å£„Å¶",
          "‰∏ÄÁîü„ÅÆÂÆùÁâ©",
          "„ÇÑ„Åå„Å¶Â§ß‰∫∫„Å´„Å™„Å£„Å¶",
          "Êâã„ÅåÂ±ä„Åã„Å™„Åè„Å™„Å£„Å¶„ÇÇ",
          "Ê∞ó‰ªò„Åë„Å∞Èö£„Å´„ÅØ",
          "„ÅÇ„ÅÆÊó•„ÅÆÂÉï„Çâ„ÅåÂ±Ö„Çã„Å†„Çç„ÅÜ",
          "„ÅÑ„Å§„ÅãÊú™Êù•„Åß‰ºö„Åà„Åü„Çâ",
          "Âêõ„Å´‰ºù„Åà„Çã„Çà",
          "„Åæ„ÅüÂ•Ω„Åç„Å£„Å¶",
          "Âº∑„ÅèË®Ä„ÅÜ„Åã„Çâ„Å≠"
        ],
        "lyrics_romaji": [
          "Kyou wa kimi to deatte kara",
          "San to yon kagetsu ga tatte",
          "Kawarazu tegami ga todoku no wa",
          "Towa ni tsuzuite darou ne",
          "Pea ringu katate doushi tsukete",
          "Te tsunaide sakamichi nobotte",
          "Kyuujitsu gorogoro shinagara mo",
          "Nanigenai hibi wo sugoshite ikun da",
          "Suki sa",
          "Umarekawatte mo",
          "Kitto kimi no moto e to",
          "Mukae ni iku darou",
          "Sekaijuu ni konna suteki na hito wa mitomaranai naa",
          "Kamera de wanshotto tsuushotto nante",
          "Itoshikute niyakete komacchau na",
          "Kimi no egao wo zutto nagametetara",
          "Hazukashii na",
          "Me to me awasete hora mata",
          "Kimi ni koishiteru",
          "Baibai suru toki wa kanarazu",
          "Ookiku te wo furiau bokura",
          "Fui ni dakitsuite kuru kimi",
          "Afureru shiawase no mainichi",
          "Kitto kono saki nannen mo",
          "Tomo ni ayunde darou ne",
          "Dakara koso no ippo zutsu wo",
          "Taisetsu ni shite ikou ne",
          "Daisuki sa",
          "Kore ijou no shiawase wo",
          "Kotoba ni nosete",
          "Tsutaete iku kara",
          "Only girl",
          "Kimi ijou no hito nante doko ni mo inai yo",
          "Tatoe kenka shitatte",
          "Hanare kaketatte",
          "Unmei no hito ni kawari wa nai kara",
          "Kono suteki na hito ga boku no taisetsu na koibito da to",
          "Sekaijuu ni jiman shite",
          "Hibi ni hana wo sakasu",
          "Hyakunen go mo",
          "Kimi wo aishite iru jishin shika nai na",
          "Nee",
          "Itsumo doori",
          "Nanigenai kaiwa datte",
          "Isshou no takaramono",
          "Yagate otona ni natte",
          "Te ga todokanaku natte mo",
          "Kidzukeba tonari ni wa",
          "Ano hi no bokura ga iru darou",
          "Itsuka mirai de aetara",
          "Kimi ni tsutaeru yo",
          "Mata suki tte",
          "Tsuyoku iu kara ne"
        ],
        "lyrics_zh": [
          "‰ªäÂ§©ÊòØÈÅáË¶ã‰Ω†ÁöÑÊó•Â≠ê",
          "‰∏âÂõõÂÄãÊúàÈÅéÂéª‰∫Ü",
          "‰∏çËÆäÁöÑÊòØÊî∂Âà∞‰Ω†ÁöÑ‰ø°",
          "ÈÄôÂ§ßÊ¶ÇÊúÉÊ∞∏ÈÅ†ÊåÅÁ∫å‰∏ãÂéªÂêß",
          "Êà¥Ëëó‰∏ÄÊ®£ÁöÑÂ∞çÊàí",
          "ÊâãÁâΩÊâãËµ∞‰∏äÊñúÂù°",
          "ÂÅáÊó•Ë£°ÈõñÁÑ∂Êá∂Êï£",
          "‰πüÂ∫¶ÈÅéÂπ≥Âá°ÁöÑÊó•Â≠ê",
          "ÂñúÊ≠°‰Ω†",
          "Âç≥‰ΩøÈáçÁîü",
          "‰∏ÄÂÆöÊúÉÂéªÊâæ‰Ω†",
          "ËøéÊé•‰Ω†",
          "‰∏ñÁïå‰∏äÊâæ‰∏çÂà∞ÈÄôÈ∫ºÊ£íÁöÑ‰∫∫",
          "ÊãçÁÖßÊôÇÁöÑ‰∏ÄÂºµ‰∏ÄÂºµ",
          "ËÆì‰∫∫Âøç‰∏ç‰ΩèÂæÆÁ¨ë",
          "ÁúãËëó‰Ω†ÁöÑÁ¨ëÂÆπ",
          "ÂÆ≥Áæû‰∫Ü",
          "ÂÜç‰∏ÄÊ¨°ÁúºÁ•û‰∫§ÊúÉ",
          "ÂèàÊÑõ‰∏ä‰Ω†",
          "ÂàÜÂà•ÊôÇ‰∏ÄÂÆöÊúÉ",
          "ÊèÆÊâãÂÜçË¶ã",
          "‰Ω†Á™ÅÁÑ∂ÊìÅÊä±Êàë",
          "ÊØèÂ§©ÂÖÖÊªøÂπ∏Á¶è",
          "ÈÄô‰πãÂæåÂ•ΩÂ§öÂπ¥",
          "ÊàëÂÄëÊúÉ‰∏ÄÁõ¥‰∏ÄËµ∑Ëµ∞‰∏ãÂéª",
          "‰∏ÄÊ≠•Ê≠•Â∞èÂøÉÁèçÊÉú",
          "ÊàëÁúüÁöÑÂæàÂñúÊ≠°‰Ω†",
          "ÊúÉÊääÈÄô‰ªΩÂπ∏Á¶è",
          "Áî®Ë®ÄË™ûÂÇ≥ÈÅîÁµ¶‰Ω†",
          "ÂîØ‰∏ÄÁöÑÂ•≥Â≠©",
          "Ê≤íÊúâ‰∫∫ÊØî‰Ω†Êõ¥ÈáçË¶Å",
          "Â∞±ÁÆóÂêµÊû∂",
          "Â∞±ÁÆóÂø´Ë¶ÅÂàÜÈñã",
          "‰πü‰∏çÊúÉÊîπËÆäÊàëÂÄëÊòØÂëΩ‰∏≠Ë®ªÂÆö",
          "ÊàëÊúÉÂêëÂÖ®‰∏ñÁïåÁÇ´ËÄÄË™™",
          "„ÄåÈÄôÈ∫ºÊ£íÁöÑ‰∫∫ÊòØÊàëÁèçÊÑõÁöÑÊàÄ‰∫∫„Äç",
          "ËÆìÊàëÂÄëÂú®Êó•Â≠ê‰∏≠Á∂ªÊîæËä±Êúµ",
          "‰∏ÄÁôæÂπ¥Âæå",
          "ÊàëÂè™ÊúÉË∂ä‰æÜË∂äÊÑõ‰Ω†",
          "Âòø",
          "Â∞±ÂÉèÂæÄÂ∏∏‰∏ÄÊ®£",
          "ÁÑ°ÊÑèÈñìÁöÑÂ∞çË©±",
          "ÊòØ‰∏ÄÁîüÁöÑÂØ∂Ëóè",
          "Âç≥‰ΩøÊº∏Êº∏Èï∑Â§ß",
          "Âç≥‰ΩøÊâãÂÜç‰πüÁ¢∞‰∏çÂà∞",
          "ÂõûÈ†≠Áúã",
          "ÊàëÂÄë‰æùÁÑ∂Âú®‰∏ÄËµ∑",
          "Â¶ÇÊûúÊúâ‰∏ÄÂ§©Âú®Êú™‰æÜÁõ∏ÈÅá",
          "ÊàëÊúÉÂëäË®¥‰Ω†",
          "ÊàëÈÇÑÊòØÂæàÊÑõ‰Ω†",
          "ÊàëÊúÉÂæàÂ†ÖÂÆöÂú∞Ë™™"
        ]
      }
    ];

    const lyricsList = document.getElementById("lyricsList");
    const lyricsDetails = document.getElementById("lyricsDetails");
    const pageHeader = document.getElementById("pageHeader");
    const songTitleElem = document.getElementById("songTitle");
    const fullLyricsElem = document.getElementById("fullLyrics");
    const themeToggleBtn = document.getElementById("themeToggle");
    let currentSong = null;

    function listSongs() {
      lyricsList.innerHTML = "";
      lyricsData.forEach((song, index) => {
        const li = document.createElement("li");
        li.tabIndex = 0;
        li.textContent = `${song.title} - ${song.artist}`;
        li.onclick = () => selectSong(index);
        li.onkeypress = (e) => { if(e.key === 'Enter') selectSong(index); };
        lyricsList.appendChild(li);
      });
    }

    function selectSong(index) {
      currentSong = lyricsData[index];
      pageHeader.style.display = "none";
      lyricsList.style.display = "none";
      lyricsDetails.style.display = "block";
      songTitleElem.textContent = `${currentSong.title} - ${currentSong.artist}`;

      const ja = currentSong.lyrics_ja || [];
      const romaji = currentSong.lyrics_romaji || [];
      const zh = currentSong.lyrics_zh || [];

      const maxLines = Math.max(ja.length, romaji.length, zh.length);
      let combinedLyrics = "";

      for (let i = 0; i < maxLines; i++) {
        combinedLyrics += (ja[i] || "") + "\n";
        combinedLyrics += (romaji[i] || "") + "\n";
        combinedLyrics += (zh[i] || "") + "\n\n";
      }

      fullLyricsElem.textContent = combinedLyrics;
      history.pushState({ index }, "", `#${encodeURIComponent(currentSong.title)}`);
    }

    function goBack() {
      currentSong = null;
      lyricsDetails.style.display = "none";
      pageHeader.style.display = "block";
      lyricsList.style.display = "block";
      history.pushState({}, "", window.location.pathname);
    }

    function setFontSize(size) {
      let fontSize;
      switch(size) {
        case 'small': fontSize = '14px'; break;
        case 'medium': fontSize = '16px'; break;
        case 'large': fontSize = '18px'; break;
        case 'xlarge': fontSize = '20px'; break;
        default: fontSize = '16px';
      }
      document.documentElement.style.setProperty('--lyrics-font-size', fontSize);
    }

    function searchLyrics() {
      const query = document.getElementById("search").value.trim().toLowerCase();
      if(!query) {
        listSongs();
        return;
      }
      const filtered = lyricsData.filter(song => {
        return song.title.toLowerCase().includes(query) ||
               song.artist.toLowerCase().includes(query) ||
               (song.lyrics_zh.join(' ').toLowerCase().includes(query)) ||
               (song.lyrics_ja.join(' ').toLowerCase().includes(query)) ||
               (song.lyrics_romaji.join(' ').toLowerCase().includes(query));
      });
      lyricsList.innerHTML = "";
      if(filtered.length === 0) {
        lyricsList.textContent = "Êâæ‰∏çÂà∞Áõ∏ÈóúÊ≠åË©û";
        return;
      }
      filtered.forEach((song) => {
        const li = document.createElement("li");
        li.tabIndex = 0;
        li.textContent = `${song.title} - ${song.artist}`;
        li.onclick = () => selectSong(lyricsData.indexOf(song));
        li.onkeypress = (e) => { if(e.key === 'Enter') selectSong(lyricsData.indexOf(song)); };
        lyricsList.appendChild(li);
      });
    }

    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute("data-theme") || "light";
      const newTheme = currentTheme === "light" ? "dark" : "light";
      document.documentElement.setAttribute("data-theme", newTheme);
      themeToggleBtn.textContent = newTheme === "light" ? "üåô" : "‚òÄÔ∏è";
    }
    themeToggleBtn.onclick = toggleTheme;

    window.onload = () => {
      document.documentElement.setAttribute("data-theme", "light");
      listSongs();
      if(location.hash) {
        const title = decodeURIComponent(location.hash.slice(1));
        const idx = lyricsData.findIndex(s => s.title === title);
        if(idx !== -1) selectSong(idx);
      }
    };

    window.addEventListener('popstate', (event) => {
      if (event.state && typeof event.state.index === 'number') {
        selectSong(event.state.index);
      } else {
        goBack();
      }
    });
  </script>
</body>
</html>
